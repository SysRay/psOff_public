#include "common.h"
#include "logging.h"
#include "types.h"

LOG_DEFINE_MODULE(libSceSysmodule);

namespace {
const char* sce_modules[] = {
    /* 0x0000 */ nullptr,
    /* 0x0001 */ nullptr,
    /* 0x0002 */ nullptr,
    /* 0x0003 */ nullptr,
    /* 0x0004 */ nullptr,
    /* 0x0005 */ nullptr,
    /* 0x0006 */ "libSceFiber",
    /* 0x0007 */ "libSceUlt",
    /* 0x0008 */ nullptr,
    /* 0x0009 */ nullptr,
    /* 0x000a */ nullptr,
    /* 0x000b */ "libSceNgs2",
    /* 0x000c */ nullptr,
    /* 0x000d */ nullptr,
    /* 0x000e */ nullptr,
    /* 0x000f */ nullptr,
    /* 0x0010 */ nullptr,
    /* 0x0011 */ nullptr,
    /* 0x0012 */ nullptr,
    /* 0x0013 */ nullptr,
    /* 0x0014 */ nullptr,
    /* 0x0015 */ nullptr,
    /* 0x0016 */ nullptr,
    /* 0x0017 */ "libSceXml",
    /* 0x0018 */ nullptr,
    /* 0x0019 */ "libSceNpUtility",
    /* 0x001a */ "libSceVoice",
    /* 0x001b */ "libSceVoiceQos",
    /* 0x001c */ "libSceNpMatching2",
    /* 0x001d */ nullptr,
    /* 0x001e */ "libSceNpScoreRanking",
    /* 0x001f */ nullptr,
    /* 0x0020 */ nullptr,
    /* 0x0021 */ "libSceRudp",
    /* 0x0022 */ nullptr,
    /* 0x0023 */ nullptr,
    /* 0x0024 */ nullptr,
    /* 0x0025 */ nullptr,
    /* 0x0026 */ nullptr,
    /* 0x0027 */ nullptr,
    /* 0x0028 */ nullptr,
    /* 0x0029 */ nullptr,
    /* 0x002a */ nullptr,
    /* 0x002b */ nullptr,
    /* 0x002c */ "libSceNpTus",
    /* 0x002d */ nullptr,
    /* 0x002e */ nullptr,
    /* 0x002f */ nullptr,
    /* 0x0030 */ nullptr,
    /* 0x0031 */ nullptr,
    /* 0x0032 */ nullptr,
    /* 0x0033 */ nullptr,
    /* 0x0034 */ nullptr,
    /* 0x0035 */ nullptr,
    /* 0x0036 */ nullptr,
    /* 0x0037 */ nullptr,
    /* 0x0038 */ "libSceFace",
    /* 0x0039 */ "libSceSmart",
    /* 0x003a */ nullptr,
    /* 0x003b */ nullptr,
    /* 0x003c */ nullptr,
    /* 0x003d */ nullptr,
    /* 0x003e */ nullptr,
    /* 0x003f */ nullptr,
    /* 0x0040 */ nullptr,
    /* 0x0041 */ nullptr,
    /* 0x0042 */ nullptr,
    /* 0x0043 */ nullptr,
    /* 0x0044 */ nullptr,
    /* 0x0045 */ nullptr,
    /* 0x0046 */ nullptr,
    /* 0x0047 */ nullptr,
    /* 0x0048 */ nullptr,
    /* 0x0049 */ nullptr,
    /* 0x004a */ nullptr,
    /* 0x004b */ nullptr,
    /* 0x004c */ nullptr,
    /* 0x004d */ nullptr,
    /* 0x004e */ nullptr,
    /* 0x004f */ nullptr,
    /* 0x0050 */ nullptr,
    /* 0x0051 */ nullptr,
    /* 0x0052 */ nullptr,
    /* 0x0053 */ nullptr,
    /* 0x0054 */ nullptr,
    /* 0x0055 */ nullptr,
    /* 0x0056 */ nullptr,
    /* 0x0057 */ nullptr,
    /* 0x0058 */ nullptr,
    /* 0x0059 */ nullptr,
    /* 0x005a */ nullptr,
    /* 0x005b */ nullptr,
    /* 0x005c */ nullptr,
    /* 0x005d */ nullptr,
    /* 0x005e */ nullptr,
    /* 0x005f */ nullptr,
    /* 0x0060 */ nullptr,
    /* 0x0061 */ nullptr,
    /* 0x0062 */ nullptr,
    /* 0x0063 */ nullptr,
    /* 0x0064 */ nullptr,
    /* 0x0065 */ nullptr,
    /* 0x0066 */ nullptr,
    /* 0x0067 */ nullptr,
    /* 0x0068 */ nullptr,
    /* 0x0069 */ nullptr,
    /* 0x006a */ nullptr,
    /* 0x006b */ nullptr,
    /* 0x006c */ nullptr,
    /* 0x006d */ nullptr,
    /* 0x006e */ nullptr,
    /* 0x006f */ nullptr,
    /* 0x0070 */ nullptr,
    /* 0x0071 */ nullptr,
    /* 0x0072 */ nullptr,
    /* 0x0073 */ nullptr,
    /* 0x0074 */ nullptr,
    /* 0x0075 */ nullptr,
    /* 0x0076 */ nullptr,
    /* 0x0077 */ nullptr,
    /* 0x0078 */ nullptr,
    /* 0x0079 */ nullptr,
    /* 0x007a */ nullptr,
    /* 0x007b */ nullptr,
    /* 0x007c */ nullptr,
    /* 0x007d */ nullptr,
    /* 0x007e */ nullptr,
    /* 0x007f */ nullptr,
    /* 0x0080 */ "libSceJson",
    /* 0x0081 */ "libSceGameLiveStreaming",
    /* 0x0082 */ "libSceCompanionUtil",
    /* 0x0083 */ "libScePlayGo",
    /* 0x0084 */ "libSceFont",
    /* 0x0085 */ "libSceVideoRecording",
    /* 0x0086 */ "libSceS3DConversion",
    /* 0x0087 */ nullptr,
    /* 0x0088 */ "libSceAudiodec",
    /* 0x0089 */ nullptr,
    /* 0x008a */ "libSceJpegDec",
    /* 0x008b */ "libSceJpegEnc",
    /* 0x008c */ "libScePngDec",
    /* 0x008d */ "libScePngEnc",
    /* 0x008e */ "libSceVideodec",
    /* 0x008f */ "libSceMove",
    /* 0x0090 */ nullptr,
    /* 0x0091 */ "libScePadTracker",
    /* 0x0092 */ "libSceDepth",
    /* 0x0093 */ "libSceHand",
    /* 0x0094 */ nullptr,
    /* 0x0095 */ "libSceIme",
    /* 0x0096 */ "libSceImeDialog",
    /* 0x0097 */ "libSceNpParty",
    /* 0x0098 */ "libSceFontFt",
    /* 0x0099 */ "libSceFreeTypeOt",
    /* 0x009a */ "libSceFreeTypeOl",
    /* 0x009b */ "libSceFreeTypeOptOl",
    /* 0x009c */ "libSceScreenShot",
    /* 0x009d */ "libSceNpAuth",
    /* 0x009e */ nullptr,
    /* 0x009f */ "libSceSulpha",
    /* 0x00a0 */ "libSceSaveDataDialog",
    /* 0x00a1 */ nullptr,
    /* 0x00a2 */ "libSceInvitationDialog",
    /* 0x00a3 */ nullptr,
    /* 0x00a4 */ "libSceMsgDialog",
    /* 0x00a5 */ "libSceAvPlayer",
    /* 0x00a6 */ "libSceContentExport",
    /* 0x00a7 */ "libSceAudio3d",
    /* 0x00a8 */ "libSceNpCommerce",
    /* 0x00a9 */ "libSceMouse",
    /* 0x00aa */ "libSceCompanionHttpd",
    /* 0x00ab */ "libSceWebBrowserDialog",
    /* 0x00ac */ "libSceErrorDialog",
    /* 0x00ad */ "libSceNpTrophy",
    /* 0x00ae */ "libSceVideoCoreInterface",
    /* 0x00af */ "libSceVideoCoreServerInterface",
    /* 0x00b0 */ "libSceNpSnsFacebookDialog",
    /* 0x00b1 */ "libSceMoveTracker",
    /* 0x00b2 */ "libSceNpProfileDialog",
    /* 0x00b3 */ "libSceNpFriendListDialog",
    /* 0x00b4 */ "libSceAppContent",
    /* 0x00b5 */ "libSceNpSignaling",
    /* 0x00b6 */ "libSceRemoteplay",
    /* 0x00b7 */ "libSceUsbd",
    /* 0x00b8 */ "libSceGameCustomDataDialog",
    /* 0x00b9 */ "libSceNpEulaDialog",
    /* 0x00ba */ "libSceRandom",
    /* 0x00bb */ nullptr,
    /* 0x00bc */ "libSceM4aacEnc",
    /* 0x00bd */ "libSceAudiodecCpu",
    /* 0x00be */ "libSceAudiodecCpuDdp",
    /* 0x00bf */ nullptr,
    /* 0x00c0 */ "libSceAudiodecCpuM4aac",
    /* 0x00c1 */ "libSceBemp2sys",
    /* 0x00c2 */ "libSceBeisobmf",
    /* 0x00c3 */ "libScePlayReady",
    /* 0x00c4 */ "libSceVideoNativeExtEssential",
    /* 0x00c5 */ "libSceZlib",
    /* 0x00c6 */ "libSceDtcpIp",
    /* 0x00c7 */ "libSceContentSearch",
    /* 0x00c8 */ "libSceShareUtility",
    /* 0x00c9 */ "libSceAudiodecCpuDtsHdLbr",
    /* 0x00ca */ nullptr,
    /* 0x00cb */ nullptr,
    /* 0x00cc */ "libSceGameUpdate",
    /* 0x00cd */ "libSceAutoMounterClient",
    /* 0x00ce */ "libSceSystemGesture",
    /* 0x00cf */ "libSceVideoDec2",
    /* 0x00d0 */ "libSceVdecwrap",
    /* 0x00d1 */ "libSceAt9Enc",
    /* 0x00d2 */ "libSceConvertKeycode",
    /* 0x00d3 */ "libSceSharePlay",
    /* 0x00d4 */ "libSceHmd",
    /* 0x00d5 */ "libSceUsbStorage",
    /* 0x00d6 */ "libSceUsbStorageDialog",
    /* 0x00d7 */ "libSceDiscMap",
    /* 0x00d8 */ "libSceFaceTracker",
    /* 0x00d9 */ "libSceHandTracker",
    /* 0x00da */ "libSceNpSnsYouTubeDialog",
    /* 0x00db */ nullptr,
    /* 0x00dc */ "libSceProfileCacheExternal",
    /* 0x00dd */ "libSceMusicPlayerService",
    /* 0x00de */ "libSceSpSysCallWrapper",
    /* 0x00df */ "libScePs2EmuMenuDialog",
    /* 0x00e0 */ "libSceNpSnsDailyMotionDialog",
    /* 0x00e1 */ "libSceAudiodecCpuHevag",
    /* 0x00e2 */ "libSceLoginDialog",
    /* 0x00e3 */ "libSceLoginService",
    /* 0x00e4 */ "libSceSigninDialog",
    /* 0x00e5 */ "libSceVdecsw",
    /* 0x00e6 */ "libSceCustomMusicCore",
    /* 0x00e7 */ "libSceJson2",
    /* 0x00e8 */ "libSceAudioLatencyEstimation",
    /* 0x00e9 */ "libSceWkFontConfig",
    /* 0x00ea */ nullptr,
    /* 0x00eb */ "libSceHmdSetupDialog",
    /* 0x00ec */ nullptr,
    /* 0x00ed */ "libSceVrTracker",
    /* 0x00ee */ "libSceContentDelete",
    /* 0x00ef */ "libSceImeBackend",
    /* 0x00f0 */ "libSceNetCtlApDialog",
    /* 0x00f1 */ "libScePlayGoDialog",
    /* 0x00f2 */ "libSceSocialScreen",
    /* 0x00f3 */ "libSceEditMp4",
    /* 0x00f4 */ nullptr,
    /* 0x00f5 */ "libScePsmKitSystem",
    /* 0x00f6 */ "libSceTextToSpeech",
    /* 0x00f7 */ "libSceNpToolkit",
    /* 0x00f8 */ "libSceCustomMusicService",
    /* 0x00f9 */ "libSceClSysCallWrapper",
    /* 0x00fa */ "libSceSystemLogger",
    /* 0x00fb */ "libSceBluetoothHid",
    /* 0x00fc */ "libSceVideoDecoderArbitration",
    /* 0x00fd */ "libSceVrServiceDialog",
    /* 0x00fe */ "libSceJobManager",
    /* 0x00ff */ "libSceShareFactoryUtil",
    /* 0x0100 */ "libSceSocialScreenDialog",
    /* 0x0101 */ "libSceNpSnsDialog",
    /* 0x0102 */ nullptr,
    /* 0x0103 */ "libSceSrcUtl",
    /* 0x0104 */ "libSceDiscId",
    /* 0x0105 */ "libSceNpUniversalDataSystem",
    /* 0x0106 */ "libSceKeyboard",
    /* 0x0107 */ "libSceGic",
};

static inline const char* getlibname(uint16_t id) {
  return id <= 0x0107 ? sce_modules[id] : nullptr;
}
} // namespace

extern "C" {

EXPORT const char* MODULE_NAME = "libSceSysmodule";

EXPORT SYSV_ABI int sceSysmoduleLoadModule(uint16_t id) {
  LOG_USE_MODULE(libSceSysmodule);
  LOG_DEBUG(L"id = 0x%x (%S)", id, getlibname(id));
  return Ok;
}

EXPORT SYSV_ABI int sceSysmoduleUnloadModule(uint16_t id) {
  LOG_USE_MODULE(libSceSysmodule);
  LOG_DEBUG(L"id = 0x%x (%S)", id, getlibname(id));
  return Ok;
}

EXPORT SYSV_ABI int sceSysmoduleIsLoaded(uint16_t id) {
  LOG_USE_MODULE(libSceSysmodule);
  LOG_DEBUG(L"id = 0x%x (%S)", id, getlibname(id));
  return Ok;
}

EXPORT SYSV_ABI int sceSysmoduleLoadModuleInternalWithArg(uint16_t id, int arg1, int arg2, int arg3, int* ret) {
  *ret = 0;

  return Ok;
}
}
